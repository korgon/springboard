<div class="heading">
  <div class="title">
    <div class="logo"></div>
    <div class="subtitle" ng-click="showMenu = !showMenu">SPRIΠGBOΛRD</div>
  </div>
  <div class="mainmenu" ng-include src="'/partials/_above_menu.html'" ng-class="{ 'show': showMenu }" ng-init="showMenu = false"></div>
  <input id="frameurl" name="url" autocomplete="off" spellcheck="false" ng-model="vm.session.url" ng-change="vm.saveEditorSession()">
  <div class="openurl" ng-click="vm.openUrl()"></div>
  <div class="line"></div>
  <div class="worksite"><a class="currentsite" ng-click="vm.session.showOptions = !vm.session.showOptions"><span id="currentsite">{{ vm.site.name }}</span></a>
    <div class="optionselect" ng-class="{'show': vm.session.showOptions}">

      <ul class="tabcontrol">
        <li><a ng-class="{ 'active': (vm.session.current_tab == 'uigen')}" ng-click="vm.switchTab('uigen')"><span class="icon modules"></span></a></li>
        <li><a ng-class="{ 'active': (vm.session.current_tab == 'settings')}" ng-click="vm.switchTab('settings')"><span class="icon config"></span></a></li>
      </ul>

      <div ng-if="vm.session.current_tab" ng-switch="vm.session.current_tab">

        <div ng-switch-when="settings" ng-init="vm.initVtab('default')">
          <div class="tabwrap">
            <div class="header settings"><span>settings</span></div>
          </div>

          <div>
            <div class="vtabwrap">
              <div class="vtabcontrolwrap">
                <ul class="vtabcontrol">
                  <li><a ng-class="{ 'active': vm.activeVtab('default') == 'variables' }" ng-click="vm.switchVtab('variables', 'default')"><span class="icon variables"></span></a></li>
                  <li><a ng-class="{ 'active': vm.activeVtab('default') == 'files' }" ng-click="vm.switchVtab('files', 'default')"><span class="icon files"></span></a></li>
                  <li><a ng-class="{ 'active': vm.activeVtab('default') == 'proxy' }" ng-click="vm.switchVtab('proxy', 'default')"><span class="icon proxy"></span></a></li>
                </ul>
              </div>
              <div class="vtabcontents" ng-switch="vm.session.tab['settings'].vtab['default'].tab">

                <div ng-switch-when="variables">
                  <div class="vtabhead">{{ vm.session.tab['settings'].vtab['default'].tab }}</div>
                  <ul class="settings-variables">
                  </ul>
                  <div class="buttons"><button class="button"><span class="icon undo"></span>Reset</button><button class="button"><span class="icon save"></span>Save</button></div>
                </div>

                <div ng-switch-when="files">
                  <div class="vtabhead">{{ vm.session.tab['settings'].vtab['default'].tab }}</div>
                  <ul class="settings-files">
                  </ul>
                </div>

                <div ng-switch-when="proxy">
                  <div class="vtabhead">{{ vm.session.tab['settings'].vtab['default'].tab }}</div>
                  <ul class="settings-proxy">
                  </ul>
                  <div class="buttons"><button class="button"><span class="icon undo"></span>Reset</button><button class="button"><span class="icon save"></span>Save</button></div>
                </div>

              </div>
            </div>
          </div>

          <div class="spacer"></div>
        </div>

        <div ng-switch-when="uigen">
          <div class="tabwrap">
            <div class="header ui"><span>UI Generator</span></div>
          </div>

          <div class="modulescroller">
            <ul class="modulechoices">
              <li ng-repeat="module in vm.site.modules" id="{{ 'module_' + module.name }}" ng-init="vm.initVtab(module.name)">
                <div class="module" ng-class="{ active: vm.session.tab['uigen'].vtab[module.name].visible }" ng-click="vm.toggleUI(module.name)">
                  <span class="brackets">[</span>
                  <span>{{ module.name }}</span>
                  <span class="brackets">]</span>
                </div>
                <div ng-if="vm.session.tab['uigen'].vtab[module.name].visible">
                  <div class="vtabwrap">
                    <div class="vtabcontrolwrap">
                      <ul class="vtabcontrol">
                        <li><a ng-class="{ 'active': vm.activeVtab(module.name) == 'plugins' }" ng-click="vm.switchVtab('plugins', module.name)"><span class="icon plugins"></span></a></li>
                        <li><a ng-class="{ 'active': vm.activeVtab(module.name) == 'themes' }" ng-click="vm.switchVtab('themes', module.name)"><span class="icon themes"></span></a></li>
                        <li><a ng-class="{ 'active': vm.activeVtab(module.name) == 'variables' }" ng-click="vm.switchVtab('variables', module.name)"><span class="icon variables"></span></a></li>
                        <li><a ng-class="{ 'active': vm.activeVtab(module.name) == 'settings' }" ng-click="vm.switchVtab('settings', module.name)"><span class="icon settings"></span></a></li>
                      </ul>
                    </div>
                    <div class="vtabcontents" ng-switch="vm.session.tab['uigen'].vtab[module.name].tab">

                      <div ng-switch-when="plugins">
                        <div class="vtabhead">{{ vm.session.tab['uigen'].vtab[module.name].tab }}</div>
                        <ul class="modulemodules">
                        </ul>
                      </div>
                      <div ng-switch-when="themes">
                        <div class="vtabhead">{{ vm.session.tab['uigen'].vtab[module.name].tab }}</div>
                        <ul class="modulethemes">
                          <li ng-repeat="theme in vm.site.modules[module.name].themes">
                            <span class="themename">{{ theme.name }}</span>
                            <span title="custom" class="icon custom disabled" ng-if="!vm.modules[module.type].themes[theme.name]"></span>
                            <span title="installed" class="icon install disabled" ng-if="vm.modules[module.type].themes[theme.name]"></span>
                            <span title="{{ vm.site.modules[module.name].theme == theme.name ? 'active' : 'inactive' }}" class="icon active" ng-class="{ 'off': vm.site.modules[module.name].theme != theme.name, 'on': vm.site.modules[module.name].theme == theme.name }" ng-click="vm.useModuleTheme({ module: module.name, theme: theme.name });"></span>
                          </li>
                          <li ng-repeat="theme in vm.modules[module.type].themes" ng-if="!vm.site.modules[module.name].themes[theme.name]">
                            <span class="themename">{{ theme.name }}</span>
                            <span title="{{ vm.site.modules[module.name].themes[theme.name] ? 'installed' : 'install' }}" class="icon install" ng-class="{ 'disabled': vm.site.modules[module.name].themes[theme.name] }" ng-click="vm.installModuleTheme({ module: module.name, theme: theme.name })"></span>
                            <span title="{{ vm.site.modules[module.name].theme == theme.name ? 'active' : 'inactive' }}" class="icon active" ng-class="{ 'off': vm.site.modules[module.name].theme != theme.name, 'on': vm.site.modules[module.name].theme == theme.name, 'hidden': !vm.site.modules[module.name].themes[theme.name] }"></span>
                          </li>
                        </ul>
                      </div>
                      <div ng-switch-when="variables">
                        <div class="vtabhead">{{ vm.session.tab['uigen'].vtab[module.name].tab }}</div>
                        <ul class="modulevariables">
                        </ul>
                        <div class="buttons"><button class="button"><span class="icon undo"></span>Reset</button><button class="button"><span class="icon save"></span>Save</button></div>
                      </div>
                      <div ng-switch-when="settings">
                        <div class="vtabhead">{{ vm.session.tab['uigen'].vtab[module.name].tab }}</div>
                        <ul class="modulesettings">
                        </ul>
                        <div class="buttons"><button class="button"><span class="icon save"></span>Save</button></div>
                      </div>
                    </div>
                  </div>
                </div>
              </li>
              <li>
                <div class="addmodule" ng-class="{ 'solo': vm.isEmpty(vm.site.modules) }">
                  <div id="addbutton" ng-click="vm.showModuleInput()" ng-hide="vm.new_module_show"><span class="add"></span></div>
                  <form id="addmoduleinput" name="addModuleForm" novalidate ng-class="{'visible' : vm.new_module_show}">
                    <label for="modulename_input">Name</label>
                    <input type="text" name="name" id="modulename_input" autocomplete="off" focus-on="moduleName" ng-model="vm.new_module.name" required ng-pattern="/^\w{3,}$/i">
                    <label for="moduletype_input">Type</label>
                    <select id="moduletype_input" required ng-model="vm.new_module.type" ng-options="module.type as module.type for module in vm.modules | orderBy: 'toString()'" ng-init="vm.new_module.type = 'v3'">
                    </select>
                    <div class="buttons">
                      <input class="button" type="submit" value="Add" ng-click="vm.installModule()" ng-disabled="addModuleForm.$invalid">
                      <input class="button" type="button" value="Cancel" ng-click="vm.hideModuleInput()">
                    </div>
                  </form>
                </div>
                <div class="spacer" ng-if="vm.isEmpty(vm.site.modules)"></div>
                <!-- <i ng-repeat="module in vm.modules">{{ module.name }}</i> -->
              </li>
            </ul>
          </div>
        </div>

      </div>

      <ul class="gitbuttons">
        <li><a ng-click="vm.commitSite()"><span class="icon commit"></span></a></li>
        <li><a ng-click="vm.pushSite()"><span class="icon push"></span></a></li>
        <li><a ng-click="vm.publishMockup()"><span class="icon upload"></span></a></li>
        <li><a ng-click="vm.prompty()"><span class="icon pull"></span></a></li>
      </ul>

    </div>
  </div>
</div>
